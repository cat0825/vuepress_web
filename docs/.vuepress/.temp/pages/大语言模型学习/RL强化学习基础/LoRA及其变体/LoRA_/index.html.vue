<template><div><h2 id="å…ƒæ•°æ®" tabindex="-1"><a class="header-anchor" href="#å…ƒæ•°æ®"><span>å…ƒæ•°æ®</span></a></h2>
<ul>
<li>åˆ†ç±»ï¼šæœºå™¨å­¦ä¹ ä¼˜åŒ–</li>
<li>æ ‡ç­¾ï¼šLoRA, é€‚é…å™¨, å­¦ä¹ ç‡, ä¼˜åŒ–å™¨, è®­ç»ƒ</li>
<li>æ—¥æœŸï¼š2025å¹´4æœˆ12æ—¥</li>
</ul>
<h2 id="å†…å®¹æ‘˜è¦" tabindex="-1"><a class="header-anchor" href="#å†…å®¹æ‘˜è¦"><span>å†…å®¹æ‘˜è¦</span></a></h2>
<p>LoRA+æ˜¯ä¸€ç§é’ˆå¯¹LoRAé€‚é…å™¨çš„ä¼˜åŒ–æ–¹æ³•ï¼Œé€šè¿‡ä¸ºçŸ©é˜µAå’ŒBè®¾ç½®ä¸åŒçš„å­¦ä¹ ç‡æ¥æé«˜è®­ç»ƒæ•ˆç‡ã€‚æ ¸å¿ƒè§‚ç‚¹æ˜¯ä½¿ç”¨ä¸åŒçš„å­¦ä¹ ç‡ç­–ç•¥ï¼Œå…¶ä¸­Bçš„å­¦ä¹ ç‡æ˜¯Açš„6å€ã€‚è¿™ç§æ–¹æ³•ä¸ä»…æå‡äº†æ¨¡å‹çš„é€‚åº”æ€§ï¼Œè¿˜ç®€åŒ–äº†ä¼˜åŒ–è¿‡ç¨‹ã€‚</p>
<h2 id="æ ¸å¿ƒå†…å®¹" tabindex="-1"><a class="header-anchor" href="#æ ¸å¿ƒå†…å®¹"><span>æ ¸å¿ƒå†…å®¹</span></a></h2>
<p><img src="/img/user/é™„ä»¶/Pasted image 20250424111627.png" alt="Pasted image 20250424111627.png"></p>
<h3 id="lora-ä¼˜åŒ–å™¨åˆ›å»º" tabindex="-1"><a class="header-anchor" href="#lora-ä¼˜åŒ–å™¨åˆ›å»º"><span>LoRA+ä¼˜åŒ–å™¨åˆ›å»º</span></a></h3>
<p>LoRA+ä¼˜åŒ–å™¨é€šè¿‡è®¾ç½®ä¸åŒçš„å­¦ä¹ ç‡æ¥å®ç°æ›´é«˜æ•ˆçš„è®­ç»ƒã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<p>âœ… <strong>å‚æ•°åˆ†ç»„</strong>ï¼š</p>
<ul>
<li>å°†æ¨¡å‹å‚æ•°åˆ†ä¸ºä¸åŒç»„ï¼Œåˆ†åˆ«è®¾ç½®å­¦ä¹ ç‡å’Œæƒé‡è¡°å‡ã€‚</li>
<li>çŸ©é˜µAçš„å­¦ä¹ ç‡ä¸º<code v-pre>lr</code>ï¼ŒçŸ©é˜µBçš„å­¦ä¹ ç‡ä¸º<code v-pre>lr * lora_lr_ratio</code>ã€‚</li>
</ul>
<p>âš ï¸ <strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p>
<ul>
<li>ç¡®ä¿æƒé‡è¡°å‡è®¾ç½®æ­£ç¡®ï¼Œé¿å…è®­ç»ƒè¿‡ç¨‹ä¸­å‡ºç°è¿‡æ‹Ÿåˆã€‚</li>
</ul>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" v-pre=""><code><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">optimizer_grouped_parameters </span><span style="--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="--shiki-light:#999999;--shiki-dark:#666666"> [</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666">    {</span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">        "</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">params</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965"> list</span><span style="--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">parameters</span><span style="--shiki-light:#999999;--shiki-dark:#666666">[</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">A</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#999999;--shiki-dark:#666666">].</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">values</span><span style="--shiki-light:#999999;--shiki-dark:#666666">()),</span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">        "</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">weight_decay</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> weight_decay</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">        "</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">lr</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> lr</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666">    },</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666">    {</span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">        "</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">params</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965"> list</span><span style="--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">parameters</span><span style="--shiki-light:#999999;--shiki-dark:#666666">[</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">embedding</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#999999;--shiki-dark:#666666">].</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">values</span><span style="--shiki-light:#999999;--shiki-dark:#666666">()),</span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">        "</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">weight_decay</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> weight_decay</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">        "</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">lr</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> lora_lr_embedding</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666">    },</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666">    {</span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">        "</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">params</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965"> list</span><span style="--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">parameters</span><span style="--shiki-light:#999999;--shiki-dark:#666666">[</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">B</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#999999;--shiki-dark:#666666">].</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">values</span><span style="--shiki-light:#999999;--shiki-dark:#666666">()),</span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">        "</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">weight_decay</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> weight_decay</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">        "</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">lr</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> lr </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676">*</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> lora_lr_ratio</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666">    },</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666">    {</span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">        "</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">params</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965"> list</span><span style="--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">parameters</span><span style="--shiki-light:#999999;--shiki-dark:#666666">[</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">B_no_decay</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#999999;--shiki-dark:#666666">].</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">values</span><span style="--shiki-light:#999999;--shiki-dark:#666666">()),</span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">        "</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">weight_decay</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91"> 0.0</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">        "</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">lr</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> lr </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676">*</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> lora_lr_ratio</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666">    },</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666">]</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">optimizer </span><span style="--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> optimizer_cls</span><span style="--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">optimizer_grouped_parameters</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676"> **</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">optimizer_kwargs</span><span style="--shiki-light:#999999;--shiki-dark:#666666">)</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è°ƒæ•´trainerç±»æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#è°ƒæ•´trainerç±»æ–¹æ³•"><span>è°ƒæ•´Trainerç±»æ–¹æ³•</span></a></h3>
<p>é‡å†™Trainerç±»çš„<code v-pre>create_optimizer</code>æ–¹æ³•ä»¥æ”¯æŒLoRA+ä¼˜åŒ–å™¨ï¼š</p>
<p>â— <strong>å®ç°æ­¥éª¤</strong>ï¼š</p>
<ol>
<li>æ£€æŸ¥æ˜¯å¦å¯ç”¨äº†Sagemakerå¤šå¤„ç†ã€‚</li>
<li>ä½¿ç”¨<code v-pre>create_lorap_optimizer</code>æ–¹æ³•åˆ›å»ºä¼˜åŒ–å™¨ã€‚</li>
</ol>
<p>ğŸ’¡ <strong>å¯å‘ç‚¹</strong>ï¼š
è¿™ç§æ–¹æ³•é€šè¿‡è°ƒæ•´å­¦ä¹ ç‡æé«˜äº†è®­ç»ƒæ•ˆç‡ï¼Œå€¼å¾—åœ¨å…¶ä»–é€‚é…å™¨ä¸­å°è¯•ã€‚</p>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" v-pre=""><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676">class</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994"> LoraPlusTrainer</span><span style="--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665">Trainer</span><span style="--shiki-light:#999999;--shiki-dark:#666666">):</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676">    def</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665"> create_optimizer</span><span style="--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666">):</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">        opt_model </span><span style="--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076"> self</span><span style="--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">model_wrapped </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">if</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> is_sagemaker_mp_enabled</span><span style="--shiki-light:#999999;--shiki-dark:#666666">()</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375"> else</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076"> self</span><span style="--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">model</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">        if</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076"> self</span><span style="--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">optimizer </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676">is</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375"> None</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">            optimizer_cls</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> optimizer_kwargs </span><span style="--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> Trainer</span><span style="--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">get_optimizer_cls_and_kwargs</span><span style="--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">args</span><span style="--shiki-light:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">            lora_lr_ratio </span><span style="--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076"> LORA_LR_RATIO</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">            lora_lr_embedding </span><span style="--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076"> LORA_LR_EMBEDDING</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076">            self</span><span style="--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">optimizer </span><span style="--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> create_lorap_optimizer</span><span style="--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">opt_model</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> lora_lr_ratio</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> optimizer_cls</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> optimizer_kwargs</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> lora_lr_embedding</span><span style="--shiki-light:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">            if</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> is_sagemaker_mp_enabled</span><span style="--shiki-light:#999999;--shiki-dark:#666666">():</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076">                self</span><span style="--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">optimizer </span><span style="--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> smp</span><span style="--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">DistributedOptimizer</span><span style="--shiki-light:#999999;--shiki-dark:#666666">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">optimizer</span><span style="--shiki-light:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">        return</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076"> self</span><span style="--shiki-light:#999999;--shiki-dark:#666666">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">optimizer</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å…¬å¼è°ƒæ•´" tabindex="-1"><a class="header-anchor" href="#å…¬å¼è°ƒæ•´"><span>å…¬å¼è°ƒæ•´</span></a></h3>
<p>å…¬å¼æ›´æ–°è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<p v-pre class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>A</mi><mo>â†</mo><mi>A</mi><mo>âˆ’</mo><mi>Î·</mi><mo>Ã—</mo><msub><mi>G</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">A \leftarrow A - \eta \times G_A
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">Î·</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p v-pre class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>B</mi><mo>â†</mo><mi>B</mi><mo>âˆ’</mo><mi>Î»</mi><mi>Î·</mi><mo>Ã—</mo><msub><mi>G</mi><mi>B</mi></msub><mo separator="true">,</mo><mspace width="1em"/><mi>Î»</mi><mo>â‰«</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">B \leftarrow B - \lambda \eta \times G_B, \quad \lambda \gg 1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Î»</span><span class="mord mathnormal" style="margin-right:0.03588em;">Î·</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">Î»</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰«</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></p>
<h2 id="å¸¸è§é”™è¯¯" tabindex="-1"><a class="header-anchor" href="#å¸¸è§é”™è¯¯"><span>å¸¸è§é”™è¯¯</span></a></h2>
<blockquote>
<p>åœ¨è°ƒæ•´å­¦ä¹ ç‡æ—¶ï¼Œç¡®ä¿æ¯”ä¾‹å…³ç³»æ­£ç¡®ï¼Œé¿å…å› è®¾ç½®é”™è¯¯å¯¼è‡´æ¨¡å‹ä¸æ”¶æ•›ã€‚</p>
</blockquote>
<h2 id="è¡ŒåŠ¨æ¸…å•" tabindex="-1"><a class="header-anchor" href="#è¡ŒåŠ¨æ¸…å•"><span>è¡ŒåŠ¨æ¸…å•</span></a></h2>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-0" disabled="disabled"><label class="task-list-item-label" for="task-item-0"> å®ç°å¹¶æµ‹è¯•LoRA+ä¼˜åŒ–å™¨åœ¨ä¸åŒæ¨¡å‹ä¸­çš„æ•ˆæœã€‚</label></li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-1" disabled="disabled"><label class="task-list-item-label" for="task-item-1"> è®°å½•è®­ç»ƒè¿‡ç¨‹ä¸­çš„å‚æ•°å˜åŒ–ä»¥éªŒè¯ä¼˜åŒ–æ•ˆæœã€‚</label></li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-2" disabled="disabled"><label class="task-list-item-label" for="task-item-2"> æ¢ç´¢å…¶ä»–é€‚é…å™¨ä¸­åº”ç”¨ç±»ä¼¼ç­–ç•¥çš„å¯è¡Œæ€§ã€‚</label></li>
</ul>
<blockquote>
<p>åŸå§‹å‡ºå¤„ï¼šsimple-lora-plus/tricks/lora_plus.py</p>
</blockquote>
</div></template>


