{"content":"<h2 id=\"元数据\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#元数据\"><span>元数据</span></a></h2>\n<ul>\n<li>分类：自然语言处理</li>\n<li>标签：P-Tuning, GPT, NLU, Embedding, Prompt</li>\n<li>日期：2025年4月12日</li>\n</ul>\n<h2 id=\"内容概述\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#内容概述\"><span>内容概述</span></a></h2>\n<p>P-Tuning是一种通过优化embedding层来增强GPT在自然语言理解任务中的方法。该方法通过将prompt转换为可学习的embedding层，并利用MLP和LSTM对其进行处理，从而使GPT更好地应用于NLU任务。\n<img src=\"/img/user/附件/Pasted image 20250423224821.png\" alt=\"Pasted image 20250423224821.png\"></p>\n<h2 id=\"主要观点\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#主要观点\"><span>主要观点</span></a></h2>\n<ol>\n<li>\n<p><strong>Prompt Encoder的引入</strong>：为了处理伪标记的相互依赖关系，P-Tuning采用了一层RNN作为Prompt Encoder，以编码prompt embedding序列。</p>\n</li>\n<li>\n<p><strong>上下文词的指定</strong>：在训练过程中，选择具有代表性语义的词作为伪标记的初始化，以确保模板在语义上与句子保持一致。</p>\n</li>\n<li>\n<p><strong>重参数化</strong>：在训练时使用Prompt Encoder来表征伪标记，并在推理阶段不再使用。</p>\n</li>\n<li>\n<p><strong>混合提示</strong>：结合连续提示与离散token，以提高模型的灵活性和适应性。</p>\n</li>\n</ol>\n<h2 id=\"操作步骤\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#操作步骤\"><span>操作步骤</span></a></h2>\n<ol>\n<li>✅ 将Prompt转换为可学习的embedding层。</li>\n<li>⚠ 使用MLP+LSTM对Prompt Embedding进行处理。</li>\n<li>❗ 在训练过程中更新embedding层中virtual token的部分参数。</li>\n</ol>\n<h2 id=\"常见错误\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#常见错误\"><span>常见错误</span></a></h2>\n<blockquote>\n<ul>\n<li>随机初始化virtual token可能导致优化到局部最优值，应使用Prompt Encoder进行编码以加速收敛。</li>\n</ul>\n</blockquote>\n<h2 id=\"💡启发点\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#💡启发点\"><span>💡启发点</span></a></h2>\n<ul>\n<li>P-Tuning通过优化embedding层而非整个模型，减少了需微调的参数量级，提高了训练效率。</li>\n</ul>\n<h2 id=\"行动清单\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#行动清单\"><span>行动清单</span></a></h2>\n<ul>\n<li>探索更多关于Prompt Encoder在不同任务中的应用。</li>\n<li>实验不同的上下文词选择策略对模型性能的影响。</li>\n<li>研究混合提示对其他语言模型的适用性。</li>\n</ul>\n<h2 id=\"数据转换\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#数据转换\"><span>数据转换</span></a></h2>\n<table>\n<thead>\n<tr>\n<th>项目</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Prompt Encoder</td>\n<td>使用RNN编码伪标记</td>\n</tr>\n<tr>\n<td>上下文词选择</td>\n<td>选择具有代表性语义的词进行初始化</td>\n</tr>\n<tr>\n<td>重参数化</td>\n<td>训练时使用，推理阶段不使用</td>\n</tr>\n</tbody>\n</table>\n<p><img src=\"/img/user/附件/Pasted image 20250423224844.png\" alt=\"Pasted image 20250423224844.png\"></p>\n<h2 id=\"公式显示\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#公式显示\"><span>公式显示</span></a></h2>\n<p v-pre class='katex-block'><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub><mo>=</mo><mi>M</mi><mi>L</mi><mi>P</mi><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><msub><mi>h</mi><mi>i</mi></msub><mo>:</mo><msub><mi>h</mi><mi>i</mi></msub><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mi>M</mi><mi>L</mi><mi>P</mi><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><mi>L</mi><mi>S</mi><mi>T</mi><mi>M</mi><mo stretchy=\"false\">(</mo><msub><mi>h</mi><mn>0</mn></msub><mo>:</mo><mi>i</mi><mo stretchy=\"false\">)</mo><mo>:</mo><mi>L</mi><mi>S</mi><mi>T</mi><mi>M</mi><mo stretchy=\"false\">(</mo><msub><mi>h</mi><mi>i</mi></msub><mo>:</mo><mi>m</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">h_i = MLP([h_i : h_i]) = MLP([LSTM(h_0 : i) : LSTM(h_i : m)]) \n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">([</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">])</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">([</span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">STM</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">STM</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)])</span></span></span></span></span></p>\n<blockquote>\n<p>来源：原始文本内容来自于技术文档，详细探讨了P-Tuning的实现及其对GPT性能提升的作用。</p>\n</blockquote>\n","env":{"base":"/","filePath":"/Users/qianyuhe/Desktop/my-project/docs/notes_bak/大语言模型学习/RL强化学习基础/PEFT参数高效微调/P-Tuning.md","filePathRelative":"notes_bak/大语言模型学习/RL强化学习基础/PEFT参数高效微调/P-Tuning.md","frontmatter":{"dg-publish":true,"dg-permalink":"/大语言模型学习/RL强化学习基础/PEFT参数高效微调/P-Tuning","dg-home":false,"dg-description":"在此输入笔记的描述","dg-hide":false,"dg-hide-title":false,"dg-show-backlinks":true,"dg-show-local-graph":true,"dg-show-inline-title":true,"dg-pinned":false,"dg-passphrase":"在此输入访问密码","dg-enable-mathjax":false,"dg-enable-mermaid":false,"dg-enable-uml":false,"dg-note-icon":0,"dg-enable-dataview":false,"tags":["NLP"],"permalink":"/大语言模型学习/RL强化学习基础/PEFT参数高效微调/P-Tuning/","dgShowBacklinks":true,"dgShowLocalGraph":true,"dgShowInlineTitle":true,"dgPassFrontmatter":true,"noteIcon":0,"created":"2025-04-23T14:46:52.009Z","updated":"2025-04-23T14:48:46.642Z","title":"P-Tuning","createTime":"2025/05/13 17:33:52"},"sfcBlocks":{"template":{"type":"template","content":"<template><h2 id=\"元数据\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#元数据\"><span>元数据</span></a></h2>\n<ul>\n<li>分类：自然语言处理</li>\n<li>标签：P-Tuning, GPT, NLU, Embedding, Prompt</li>\n<li>日期：2025年4月12日</li>\n</ul>\n<h2 id=\"内容概述\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#内容概述\"><span>内容概述</span></a></h2>\n<p>P-Tuning是一种通过优化embedding层来增强GPT在自然语言理解任务中的方法。该方法通过将prompt转换为可学习的embedding层，并利用MLP和LSTM对其进行处理，从而使GPT更好地应用于NLU任务。\n<img src=\"/img/user/附件/Pasted image 20250423224821.png\" alt=\"Pasted image 20250423224821.png\"></p>\n<h2 id=\"主要观点\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#主要观点\"><span>主要观点</span></a></h2>\n<ol>\n<li>\n<p><strong>Prompt Encoder的引入</strong>：为了处理伪标记的相互依赖关系，P-Tuning采用了一层RNN作为Prompt Encoder，以编码prompt embedding序列。</p>\n</li>\n<li>\n<p><strong>上下文词的指定</strong>：在训练过程中，选择具有代表性语义的词作为伪标记的初始化，以确保模板在语义上与句子保持一致。</p>\n</li>\n<li>\n<p><strong>重参数化</strong>：在训练时使用Prompt Encoder来表征伪标记，并在推理阶段不再使用。</p>\n</li>\n<li>\n<p><strong>混合提示</strong>：结合连续提示与离散token，以提高模型的灵活性和适应性。</p>\n</li>\n</ol>\n<h2 id=\"操作步骤\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#操作步骤\"><span>操作步骤</span></a></h2>\n<ol>\n<li>✅ 将Prompt转换为可学习的embedding层。</li>\n<li>⚠ 使用MLP+LSTM对Prompt Embedding进行处理。</li>\n<li>❗ 在训练过程中更新embedding层中virtual token的部分参数。</li>\n</ol>\n<h2 id=\"常见错误\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#常见错误\"><span>常见错误</span></a></h2>\n<blockquote>\n<ul>\n<li>随机初始化virtual token可能导致优化到局部最优值，应使用Prompt Encoder进行编码以加速收敛。</li>\n</ul>\n</blockquote>\n<h2 id=\"💡启发点\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#💡启发点\"><span>💡启发点</span></a></h2>\n<ul>\n<li>P-Tuning通过优化embedding层而非整个模型，减少了需微调的参数量级，提高了训练效率。</li>\n</ul>\n<h2 id=\"行动清单\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#行动清单\"><span>行动清单</span></a></h2>\n<ul>\n<li>探索更多关于Prompt Encoder在不同任务中的应用。</li>\n<li>实验不同的上下文词选择策略对模型性能的影响。</li>\n<li>研究混合提示对其他语言模型的适用性。</li>\n</ul>\n<h2 id=\"数据转换\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#数据转换\"><span>数据转换</span></a></h2>\n<table>\n<thead>\n<tr>\n<th>项目</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Prompt Encoder</td>\n<td>使用RNN编码伪标记</td>\n</tr>\n<tr>\n<td>上下文词选择</td>\n<td>选择具有代表性语义的词进行初始化</td>\n</tr>\n<tr>\n<td>重参数化</td>\n<td>训练时使用，推理阶段不使用</td>\n</tr>\n</tbody>\n</table>\n<p><img src=\"/img/user/附件/Pasted image 20250423224844.png\" alt=\"Pasted image 20250423224844.png\"></p>\n<h2 id=\"公式显示\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#公式显示\"><span>公式显示</span></a></h2>\n<p v-pre class='katex-block'><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub><mo>=</mo><mi>M</mi><mi>L</mi><mi>P</mi><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><msub><mi>h</mi><mi>i</mi></msub><mo>:</mo><msub><mi>h</mi><mi>i</mi></msub><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mi>M</mi><mi>L</mi><mi>P</mi><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><mi>L</mi><mi>S</mi><mi>T</mi><mi>M</mi><mo stretchy=\"false\">(</mo><msub><mi>h</mi><mn>0</mn></msub><mo>:</mo><mi>i</mi><mo stretchy=\"false\">)</mo><mo>:</mo><mi>L</mi><mi>S</mi><mi>T</mi><mi>M</mi><mo stretchy=\"false\">(</mo><msub><mi>h</mi><mi>i</mi></msub><mo>:</mo><mi>m</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">h_i = MLP([h_i : h_i]) = MLP([LSTM(h_0 : i) : LSTM(h_i : m)]) \n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">([</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">])</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">([</span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">STM</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">STM</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)])</span></span></span></span></span></p>\n<blockquote>\n<p>来源：原始文本内容来自于技术文档，详细探讨了P-Tuning的实现及其对GPT性能提升的作用。</p>\n</blockquote>\n</template>","contentStripped":"<h2 id=\"元数据\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#元数据\"><span>元数据</span></a></h2>\n<ul>\n<li>分类：自然语言处理</li>\n<li>标签：P-Tuning, GPT, NLU, Embedding, Prompt</li>\n<li>日期：2025年4月12日</li>\n</ul>\n<h2 id=\"内容概述\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#内容概述\"><span>内容概述</span></a></h2>\n<p>P-Tuning是一种通过优化embedding层来增强GPT在自然语言理解任务中的方法。该方法通过将prompt转换为可学习的embedding层，并利用MLP和LSTM对其进行处理，从而使GPT更好地应用于NLU任务。\n<img src=\"/img/user/附件/Pasted image 20250423224821.png\" alt=\"Pasted image 20250423224821.png\"></p>\n<h2 id=\"主要观点\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#主要观点\"><span>主要观点</span></a></h2>\n<ol>\n<li>\n<p><strong>Prompt Encoder的引入</strong>：为了处理伪标记的相互依赖关系，P-Tuning采用了一层RNN作为Prompt Encoder，以编码prompt embedding序列。</p>\n</li>\n<li>\n<p><strong>上下文词的指定</strong>：在训练过程中，选择具有代表性语义的词作为伪标记的初始化，以确保模板在语义上与句子保持一致。</p>\n</li>\n<li>\n<p><strong>重参数化</strong>：在训练时使用Prompt Encoder来表征伪标记，并在推理阶段不再使用。</p>\n</li>\n<li>\n<p><strong>混合提示</strong>：结合连续提示与离散token，以提高模型的灵活性和适应性。</p>\n</li>\n</ol>\n<h2 id=\"操作步骤\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#操作步骤\"><span>操作步骤</span></a></h2>\n<ol>\n<li>✅ 将Prompt转换为可学习的embedding层。</li>\n<li>⚠ 使用MLP+LSTM对Prompt Embedding进行处理。</li>\n<li>❗ 在训练过程中更新embedding层中virtual token的部分参数。</li>\n</ol>\n<h2 id=\"常见错误\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#常见错误\"><span>常见错误</span></a></h2>\n<blockquote>\n<ul>\n<li>随机初始化virtual token可能导致优化到局部最优值，应使用Prompt Encoder进行编码以加速收敛。</li>\n</ul>\n</blockquote>\n<h2 id=\"💡启发点\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#💡启发点\"><span>💡启发点</span></a></h2>\n<ul>\n<li>P-Tuning通过优化embedding层而非整个模型，减少了需微调的参数量级，提高了训练效率。</li>\n</ul>\n<h2 id=\"行动清单\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#行动清单\"><span>行动清单</span></a></h2>\n<ul>\n<li>探索更多关于Prompt Encoder在不同任务中的应用。</li>\n<li>实验不同的上下文词选择策略对模型性能的影响。</li>\n<li>研究混合提示对其他语言模型的适用性。</li>\n</ul>\n<h2 id=\"数据转换\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#数据转换\"><span>数据转换</span></a></h2>\n<table>\n<thead>\n<tr>\n<th>项目</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Prompt Encoder</td>\n<td>使用RNN编码伪标记</td>\n</tr>\n<tr>\n<td>上下文词选择</td>\n<td>选择具有代表性语义的词进行初始化</td>\n</tr>\n<tr>\n<td>重参数化</td>\n<td>训练时使用，推理阶段不使用</td>\n</tr>\n</tbody>\n</table>\n<p><img src=\"/img/user/附件/Pasted image 20250423224844.png\" alt=\"Pasted image 20250423224844.png\"></p>\n<h2 id=\"公式显示\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#公式显示\"><span>公式显示</span></a></h2>\n<p v-pre class='katex-block'><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub><mo>=</mo><mi>M</mi><mi>L</mi><mi>P</mi><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><msub><mi>h</mi><mi>i</mi></msub><mo>:</mo><msub><mi>h</mi><mi>i</mi></msub><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mi>M</mi><mi>L</mi><mi>P</mi><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><mi>L</mi><mi>S</mi><mi>T</mi><mi>M</mi><mo stretchy=\"false\">(</mo><msub><mi>h</mi><mn>0</mn></msub><mo>:</mo><mi>i</mi><mo stretchy=\"false\">)</mo><mo>:</mo><mi>L</mi><mi>S</mi><mi>T</mi><mi>M</mi><mo stretchy=\"false\">(</mo><msub><mi>h</mi><mi>i</mi></msub><mo>:</mo><mi>m</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">h_i = MLP([h_i : h_i]) = MLP([LSTM(h_0 : i) : LSTM(h_i : m)]) \n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">([</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">])</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">([</span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">STM</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">STM</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)])</span></span></span></span></span></p>\n<blockquote>\n<p>来源：原始文本内容来自于技术文档，详细探讨了P-Tuning的实现及其对GPT性能提升的作用。</p>\n</blockquote>\n","tagOpen":"<template>","tagClose":"</template>"},"script":null,"scriptSetup":null,"scripts":[],"styles":[],"customBlocks":[]},"content":"\n## 元数据\n- 分类：自然语言处理\n- 标签：P-Tuning, GPT, NLU, Embedding, Prompt\n- 日期：2025年4月12日\n\n\n## 内容概述\nP-Tuning是一种通过优化embedding层来增强GPT在自然语言理解任务中的方法。该方法通过将prompt转换为可学习的embedding层，并利用MLP和LSTM对其进行处理，从而使GPT更好地应用于NLU任务。\n![Pasted image 20250423224821.png](/img/user/%E9%99%84%E4%BB%B6/Pasted%20image%2020250423224821.png)\n\n\n## 主要观点\n1. **Prompt Encoder的引入**：为了处理伪标记的相互依赖关系，P-Tuning采用了一层RNN作为Prompt Encoder，以编码prompt embedding序列。\n   \n2. **上下文词的指定**：在训练过程中，选择具有代表性语义的词作为伪标记的初始化，以确保模板在语义上与句子保持一致。\n\n3. **重参数化**：在训练时使用Prompt Encoder来表征伪标记，并在推理阶段不再使用。\n\n4. **混合提示**：结合连续提示与离散token，以提高模型的灵活性和适应性。\n\n\n## 操作步骤\n1. ✅ 将Prompt转换为可学习的embedding层。\n2. ⚠ 使用MLP+LSTM对Prompt Embedding进行处理。\n3. ❗ 在训练过程中更新embedding层中virtual token的部分参数。\n\n\n## 常见错误\n> - 随机初始化virtual token可能导致优化到局部最优值，应使用Prompt Encoder进行编码以加速收敛。\n\n\n## 💡启发点\n- P-Tuning通过优化embedding层而非整个模型，减少了需微调的参数量级，提高了训练效率。\n\n\n## 行动清单\n- 探索更多关于Prompt Encoder在不同任务中的应用。\n- 实验不同的上下文词选择策略对模型性能的影响。\n- 研究混合提示对其他语言模型的适用性。\n\n\n## 数据转换\n| 项目           | 描述                             |\n|----------------|----------------------------------|\n| Prompt Encoder | 使用RNN编码伪标记                |\n| 上下文词选择   | 选择具有代表性语义的词进行初始化 |\n| 重参数化       | 训练时使用，推理阶段不使用       |\n\n![Pasted image 20250423224844.png](/img/user/%E9%99%84%E4%BB%B6/Pasted%20image%2020250423224844.png)\n\n\n## 公式显示\n$$ h_i = MLP([h_i : h_i]) = MLP([LSTM(h_0 : i) : LSTM(h_i : m)]) $$\n\n> 来源：原始文本内容来自于技术文档，详细探讨了P-Tuning的实现及其对GPT性能提升的作用。","excerpt":"","includedFiles":[],"tasklistId":0,"title":"","headers":[{"level":2,"title":"元数据","slug":"元数据","link":"#元数据","children":[]},{"level":2,"title":"内容概述","slug":"内容概述","link":"#内容概述","children":[]},{"level":2,"title":"主要观点","slug":"主要观点","link":"#主要观点","children":[]},{"level":2,"title":"操作步骤","slug":"操作步骤","link":"#操作步骤","children":[]},{"level":2,"title":"常见错误","slug":"常见错误","link":"#常见错误","children":[]},{"level":2,"title":"💡启发点","slug":"💡启发点","link":"#💡启发点","children":[]},{"level":2,"title":"行动清单","slug":"行动清单","link":"#行动清单","children":[]},{"level":2,"title":"数据转换","slug":"数据转换","link":"#数据转换","children":[]},{"level":2,"title":"公式显示","slug":"公式显示","link":"#公式显示","children":[]}]}}
