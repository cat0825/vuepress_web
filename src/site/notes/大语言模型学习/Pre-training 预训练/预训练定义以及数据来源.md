---
{"dg-publish":true,"dg-permalink":"/å¤§è¯­è¨€æ¨¡å‹å­¦ä¹ /Pre-training-é¢„è®­ç»ƒ/é¢„è®­ç»ƒå®šä¹‰ä»¥åŠæ•°æ®æ¥æº","dg-home":false,"dg-description":"åœ¨æ­¤è¾“å…¥ç¬”è®°çš„æè¿°","dg-hide":false,"dg-hide-title":false,"dg-show-backlinks":true,"dg-show-local-graph":true,"dg-show-inline-title":true,"dg-pinned":false,"dg-passphrase":"åœ¨æ­¤è¾“å…¥è®¿é—®å¯†ç ","dg-enable-mathjax":false,"dg-enable-mermaid":false,"dg-enable-uml":false,"dg-note-icon":0,"dg-enable-dataview":false,"tags":["NLP"],"permalink":"/å¤§è¯­è¨€æ¨¡å‹å­¦ä¹ /Pre-training-é¢„è®­ç»ƒ/é¢„è®­ç»ƒå®šä¹‰ä»¥åŠæ•°æ®æ¥æº/","dgShowBacklinks":true,"dgShowLocalGraph":true,"dgShowInlineTitle":true,"dgPassFrontmatter":true,"noteIcon":0,"created":"2025-04-08T11:56:22.000+08:00","updated":"2025-04-13T13:06:02.000+08:00"}
---



**åˆ†ç±»**ï¼šäººå·¥æ™ºèƒ½  
**æ ‡ç­¾**ï¼šé¢„è®­ç»ƒã€å¤§æ¨¡å‹ã€è‡ªç›‘ç£å­¦ä¹ ã€æ•°æ®å¤„ç†ã€Next Token Prediction  
**æ—¥æœŸ**ï¼š2023-10-10  

---



## æ ¸å¿ƒè§‚ç‚¹æ€»ç»“
å¤§æ¨¡å‹çš„é¢„è®­ç»ƒæ—¨åœ¨é€šè¿‡åœ¨å¤§è§„æ¨¡æ•°æ®é›†ä¸Šè¿›è¡Œè‡ªç›‘ç£å­¦ä¹ ï¼Œæ•æ‰é€šç”¨ç‰¹å¾å’Œæ¨¡å¼ï¼Œä»è€Œæå‡æ¨¡å‹çš„é€‚åº”æ€§å’Œæ³›åŒ–èƒ½åŠ›ã€‚é¢„è®­ç»ƒä¾èµ–äºé«˜è´¨é‡ã€å¤šé¢†åŸŸçš„æ•°æ®ï¼Œä½¿ç”¨Next Token Predictionï¼ˆNTPï¼‰ä½œä¸ºä¸»è¦è®­ç»ƒç›®æ ‡ï¼Œå¸®åŠ©æ¨¡å‹æŒæ¡è¯­è¨€å’Œå…¶ä»–å¤æ‚æŠ€èƒ½ã€‚

---



## é‡ç‚¹å†…å®¹è§£æ

### 1. **é¢„è®­ç»ƒçš„å®šä¹‰ä¸ç›®æ ‡**
- **ç›®æ ‡**ï¼š
  - é€šè¿‡åœ¨å¤§è§„æ¨¡æ•°æ®é›†ä¸Šå­¦ä¹ ï¼Œæ•æ‰é€šç”¨ç‰¹å¾å’Œæ¨¡å¼ã€‚
  - å‡å°‘å¯¹æ ‡æ³¨æ•°æ®çš„ä¾èµ–ï¼ŒåŠ é€Ÿé€‚åº”æ–°ä»»åŠ¡ã€‚
- **è®­ç»ƒæ–¹æ³•**ï¼š
  - è‡ªç›‘ç£å­¦ä¹ ï¼ˆåŒºåˆ«äºæ— ç›‘ç£å­¦ä¹ ï¼‰ã€‚
  - ä½¿ç”¨ **Next Token Prediction (NTP)** ä½œä¸ºè®­ç»ƒç›®æ ‡ï¼Œå…¶å…¬å¼ä¸ºï¼š
    $$
    L = - \sum_{n=1}^N \log p(x_n | x_1, x_2, ..., x_{n-1}; \theta)
    $$
  - æ¨¡å‹æ ¹æ®ä¸Šä¸‹æ–‡é¢„æµ‹ä¸‹ä¸€ä¸ªæœ€å¯èƒ½çš„å•è¯ï¼Œå¹¶é€šè¿‡å¯¹æ•°ä¼¼ç„¶æŸå¤±ä¼˜åŒ–ã€‚

ğŸ’¡ **å¯å‘ç‚¹**ï¼šNTPæ–¹æ³•ä¸ä»…é€‚ç”¨äºè¯­è¨€ï¼Œè¿˜èƒ½æ‰©å±•åˆ°ä»£ç ã€æ•°å­¦ç­‰é¢†åŸŸçš„é¢„æµ‹ä»»åŠ¡ã€‚

---


### 2. **é¢„è®­ç»ƒæ•°æ®çš„æ¥æºä¸è§„æ¨¡**
- **æ•°æ®é‡çº§**ï¼š
  - åˆå§‹é¢„è®­ç»ƒï¼šçº¦ 10T tokensã€‚
  - è¿›ä¸€æ­¥å¾®è°ƒï¼šè‡³å°‘ 100B tokensã€‚
- **æ•°æ®æ¥æº**ï¼š
  - **Common Crawl**ï¼šå¼€æ”¾ç½‘é¡µæ•°æ®å¹³å°ã€‚
  - **GitHub**ï¼šä»£ç ç›¸å…³æ•°æ®ã€‚
  - **ç”µå­ä¹¦ä¸æ•™è‚²èµ„æ–™**ï¼šæ¶µç›–å¤šé¢†åŸŸçŸ¥è¯†ã€‚
  - **å†…éƒ¨æ•°æ®**ï¼šä¼ä¸šè‡ªæœ‰ä¸šåŠ¡æ•°æ®ã€‚
- **å¤šè¯­ç§æ”¯æŒ**ï¼š
  - é€šç”¨æ¨¡å‹éœ€è¦†ç›–ä¸­è‹±æ–‡ï¼Œå°è¯­ç§æ ¹æ®éœ€æ±‚é€‰æ‹©æ€§æ”¶é›†ã€‚

| æ•°æ®æ¥æº         | ç‰¹ç‚¹                           |
|------------------|--------------------------------|
| Common Crawl     | ç½‘é¡µæ•°æ®ï¼Œè¦†ç›–å¹¿æ³›             |
| GitHub           | ä¸“æ³¨äºä»£ç ä¸æŠ€æœ¯               |
| æ•™è‚²èµ„æ–™ä¸è®ºæ–‡   | æä¾›é«˜è´¨é‡çŸ¥è¯†å†…å®¹             |
| å†…éƒ¨æ•°æ®         | ä¼ä¸šç‰¹å®šé¢†åŸŸçš„ä¸“å±è¯­æ–™         |

ğŸ“ˆ **è¶‹åŠ¿é¢„æµ‹**ï¼šæœªæ¥ï¼Œé«˜è´¨é‡å¤šæ¨¡æ€æ•°æ®ï¼ˆå¦‚å›¾åƒã€è§†é¢‘ä¸æ–‡æœ¬ç»“åˆï¼‰å°†æˆä¸ºé¢„è®­ç»ƒçš„é‡è¦æ–¹å‘ã€‚

---


### 3. **æ•°æ®å¤„ç†çš„æŒ‘æˆ˜**
- **é—®é¢˜**ï¼š
  - é«˜è´¨é‡æ•°æ®ï¼ˆå¦‚è®ºæ–‡ã€ä¹¦ç±ï¼‰é€šå¸¸ä»¥PDFæ ¼å¼å­˜åœ¨ï¼Œè§£æå¤æ‚ã€‚
- **è§£å†³æ–¹æ¡ˆ**ï¼š
  âœ… ä½¿ç”¨ä¸“ä¸šPDFè§£ææœåŠ¡ï¼Œé¿å…ä¾èµ–ä½æ•ˆçš„Pythonåº“ã€‚  
  âœ… è®­ç»ƒOCRæ¨¡å‹ï¼Œå‰ææ˜¯æœ‰è¶³å¤Ÿé«˜è´¨é‡çš„PDF-æ–‡æœ¬å¯¹é½æ•°æ®ã€‚  
  âš  æ³¨æ„ï¼šç›´æ¥ç”¨å¤§æ¨¡å‹ï¼ˆå¦‚GPT-4ï¼‰è§£æPDFå¯èƒ½æˆæœ¬è¿‡é«˜ã€‚  

ğŸ’¡ **å¯å‘ç‚¹**ï¼šé«˜æ•ˆçš„æ•°æ®å¤„ç†å·¥å…·æ˜¯é¢„è®­ç»ƒæˆåŠŸçš„å…³é”®ã€‚

---



## å¸¸è§é”™è¯¯ä¸æ³¨æ„äº‹é¡¹
> **âš  è­¦å‘Š**ï¼š  
> - æ•°æ®è´¨é‡ç›´æ¥å½±å“æ¨¡å‹æ€§èƒ½ï¼Œä½è´¨é‡æˆ–åå‘å•ä¸€é¢†åŸŸçš„æ•°æ®å¯èƒ½å¯¼è‡´æ¨¡å‹åœ¨å®é™…åº”ç”¨ä¸­è¡¨ç°ä¸ä½³ã€‚  
> - å¤šè¯­ç§å¤„ç†éœ€ç¡®ä¿è¯­æ–™åˆ†å¸ƒå‡è¡¡ï¼Œå¦åˆ™å¯èƒ½å½±å“å°è¯­ç§ä»»åŠ¡çš„è¡¨ç°ã€‚

---



## [æ€è€ƒ] å»¶ä¼¸é—®é¢˜
1. å¦‚ä½•ä¼˜åŒ–å¤šæ¨¡æ€æ•°æ®ï¼ˆå¦‚å›¾åƒä¸æ–‡æœ¬ï¼‰çš„è”åˆé¢„è®­ç»ƒæ–¹æ³•ï¼Ÿ  
2. åœ¨å¤šè¯­ç§æ¨¡å‹ä¸­ï¼Œå¦‚ä½•æƒè¡¡ä¸åŒè¯­ç§çš„æ•°æ®æ¯”ä¾‹ä»¥æå‡æ€§èƒ½ï¼Ÿ  
3. å¯¹äºç‰¹å®šé¢†åŸŸçš„å‚ç›´åº”ç”¨ï¼Œæ˜¯å¦éœ€è¦é‡æ–°è®¾è®¡é¢„è®­ç»ƒç›®æ ‡ï¼Ÿ

---

> **æ¥æº**ï¼šæœ¬æ–‡å†…å®¹åŸºäºå¤§æ¨¡å‹é¢„è®­ç»ƒæŠ€æœ¯æ–‡æ¡£æ•´ç†ä¸æ€»ç»“ã€‚

---



## è¡ŒåŠ¨æ¸…å•
1. âœ… è°ƒç ”ç°æœ‰çš„å¼€æºæ•°æ®é›†ï¼ˆå¦‚FineWebã€Pileã€RedPajamaï¼‰ï¼Œå¹¶å°è¯•æ•´åˆåˆ°è‡ªå·±çš„é¡¹ç›®ä¸­ã€‚  
2. âœ… å­¦ä¹ å¦‚ä½•ä½¿ç”¨ä¸“ä¸šPDFè§£ææœåŠ¡æˆ–OCRæŠ€æœ¯æå‡æ•°æ®å¤„ç†æ•ˆç‡ã€‚  
3. â— æ¢ç´¢å¤šæ¨¡æ€é¢„è®­ç»ƒæ–¹æ³•ï¼Œå…³æ³¨å›¾åƒã€æ–‡æœ¬ã€éŸ³é¢‘ç­‰å¤šç§å½¢å¼çš„æ•°æ®æ•´åˆã€‚

---



## åç»­è¿½è¸ª
- è·Ÿè¸ªæœ€æ–°å‘å¸ƒçš„å¤§è§„æ¨¡å¼€æºæ¨¡å‹åŠå…¶é¢„è®­ç»ƒæŠ€æœ¯è¿›å±•ã€‚  
- æ·±å…¥ç ”ç©¶è‡ªç›‘ç£å­¦ä¹ åœ¨éè¯­è¨€ä»»åŠ¡ï¼ˆå¦‚ä»£ç ç”Ÿæˆã€é€»è¾‘æ¨ç†ï¼‰ä¸­çš„åº”ç”¨æ½œåŠ›ã€‚



## æ•°æ®èµ„æºæ¦‚è§ˆ
ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„å¼€æºæ•°æ®é›†åŠå…¶è·å–åœ°å€ï¼š

| æ•°æ®é›†åç§°                     | åœ°å€                                                                 |
|--------------------------------|----------------------------------------------------------------------|
| Skywork/SkyPile-150B           | [ç‚¹å‡»è®¿é—®](https://huggingface.co/datasets/Skywork/SkyPile-150B)     |
| Wikipediaä¸­æ–‡20230720          | [ç‚¹å‡»è®¿é—®](https://huggingface.co/datasets/pleisto/wikipedia-cn-20230720-filtered) |
| C4                             | [ç‚¹å‡»è®¿é—®](https://github.com/allenai/allennlp/discussions/5056)     |
| RedPajama                      | [ç‚¹å‡»è®¿é—®](https://huggingface.co/datasets/togethercomputer/RedPajama-Data-V2) |
| EleutherAI/the_pile_deduplicated | [ç‚¹å‡»è®¿é—®](https://huggingface.co/datasets/EleutherAI/the_pile_deduplicated) |
| WuDaoCorporaText               | [ç‚¹å‡»è®¿é—®](https://data.baai.ac.cn/details/WuDaoCorporaText)         |
| PRM800K                        | [ç‚¹å‡»è®¿é—®](https://github.com/openai/prm800k?tab=readme-ov-file)     |
| YeungNLP/firefly-pretrain-dataset | [ç‚¹å‡»è®¿é—®](https://huggingface.co/datasets/YeungNLP/firefly-pretrain-dataset) |

ğŸ’¡ **å¯å‘ç‚¹**ï¼šè¿™äº›æ•°æ®é›†æ¶µç›–äº†å¤šè¯­è¨€ã€å¤šé¢†åŸŸçš„è¯­æ–™ï¼Œé€‚åˆç”¨äºæ„å»ºé€šç”¨å‹é¢„è®­ç»ƒæ¨¡å‹ã€‚

---



## æ•°æ®é‡‡æ ·ä¸åˆ†å¸ƒç­–ç•¥
åœ¨ç»§ç»­é¢„è®­ç»ƒä¸­ï¼Œé€šç”¨æ•°æ®çš„é‡‡æ ·ç­–ç•¥å¯¹æ¨¡å‹æ€§èƒ½å½±å“æ˜¾è‘—ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªå…·ä½“åˆ†é…æ¡ˆä¾‹ï¼š

### æ•°æ®åˆ†å¸ƒæ¯”ä¾‹
- **æ€»Tokensé‡**ï¼š100B  
- **è¯­è¨€åˆ†å¸ƒ**ï¼šä¸­æ–‡ : è‹±æ–‡ : ä»£ç  = 20% : 70% : 10%


### ä¸­æ–‡è¯­æ–™é‡‡æ ·
| æ•°æ®é›†åç§°          | Tokensæ•°é‡ (å•ä½ï¼šB) | å¤‡æ³¨                      |
|---------------------|---------------------|---------------------------|
| cc                 | 4.024               |                          |
| baidu_baike_v3     | 0.804               |                          |
| wiki_zw            | 0.1602              |                          |
| qikan              | 0.1602              |                          |
| recipe             | 0.0182              |                          |


### è‹±æ–‡è¯­æ–™é‡‡æ ·
| æ•°æ®é›†åç§°          | Tokensæ•°é‡ (å•ä½ï¼šB) | å¤‡æ³¨                      |
|---------------------|---------------------|---------------------------|
| c4                 | 32.675              |                          |
| arxiv_v2           | 3.2652              |                          |
| wiki_en            | 3.6792              |                          |


### Codeè¯­æ–™é‡‡æ ·
| æ•°æ®é›†åç§°          | Tokensæ•°é‡ (å•ä½ï¼šB) | å¤‡æ³¨                      |
|---------------------|---------------------------|
| code               | 4.9042              |                          |
| github70v1         | 1.2168              |                          |

---

> åŸå§‹å†…å®¹æ¥æºï¼š[Skywork/SkyPile-150B](https://huggingface.co/datasets/Skywork/SkyPile-150B)ã€[Wikipediaä¸­æ–‡20230720](https://huggingface.co/datasets/pleisto/wikipedia-cn-20230720-filtered)ã€[C4](https://github.com/allenai/allennlp/discussions/5056) ç­‰ã€‚
