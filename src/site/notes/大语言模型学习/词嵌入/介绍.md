---
{"dg-publish":true,"dg-permalink":"/å¤§è¯­è¨€æ¨¡åž‹å­¦ä¹ /è¯åµŒå…¥/ä»‹ç»","dg-home":false,"dg-description":"åœ¨æ­¤è¾“å…¥ç¬”è®°çš„æè¿°","dg-hide":false,"dg-hide-title":false,"dg-show-backlinks":true,"dg-show-local-graph":true,"dg-show-inline-title":true,"dg-pinned":false,"dg-passphrase":"åœ¨æ­¤è¾“å…¥è®¿é—®å¯†ç ","dg-enable-mathjax":false,"dg-enable-mermaid":false,"dg-enable-uml":false,"dg-note-icon":0,"dg-enable-dataview":false,"tags":["NLP"],"permalink":"/å¤§è¯­è¨€æ¨¡åž‹å­¦ä¹ /è¯åµŒå…¥/ä»‹ç»/","dgShowBacklinks":true,"dgShowLocalGraph":true,"dgShowInlineTitle":true,"dgPassFrontmatter":true,"noteIcon":0,"created":"2025-04-02T21:42:06.000+08:00","updated":"2025-05-07T15:21:57.000+08:00"}
---



# åšå®¢ç¬”è®°ï¼šæ·±å…¥ç†è§£è¯åµŒå…¥ï¼ˆEmbeddingï¼‰æŠ€æœ¯åŠå…¶å®žçŽ°

## å…ƒæ•°æ®
- **åˆ†ç±»**ï¼šè‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰
- **æ ‡ç­¾**ï¼šEmbeddingã€è¯å‘é‡ã€PyTorchã€æ·±åº¦å­¦ä¹ 
- **æ—¥æœŸ**ï¼š2025å¹´4æœˆ1æ—¥  

---


## 1. ä»€ä¹ˆæ˜¯è¯åµŒå…¥ï¼ˆEmbeddingï¼‰ï¼Ÿ
è¯åµŒå…¥ï¼ˆEmbeddingï¼‰æ˜¯ä¸€ç§å°†é«˜ç»´æ•°æ®ï¼ˆå¦‚æ–‡æœ¬æˆ–å›¾åƒï¼‰æ˜ å°„åˆ°ä½Žç»´å‘é‡ç©ºé—´çš„æŠ€æœ¯ã€‚å®ƒçš„æ ¸å¿ƒåŠŸèƒ½æ˜¯å°†è®¡ç®—æœºæ— æ³•ç›´æŽ¥ç†è§£çš„ç‰©ç†é‡ï¼ˆå¦‚æ–‡å­—ã€å›¾ç‰‡ã€è¯­è¨€ç­‰ï¼‰è½¬åŒ–ä¸ºè®¡ç®—æœºå¯ä»¥å¤„ç†çš„ç¨ å¯†å‘é‡ï¼ŒåŒæ—¶å°½é‡ä¿ç•™åŽŸå§‹ä¿¡æ¯ã€‚

ðŸ’¡ **å¯å‘ç‚¹**ï¼šEmbedding çš„æœ¬è´¨æ˜¯ä¸€ç§æ˜ å°„å…³ç³»ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ä»Žå¤æ‚çš„çŽ°å®žä¸–ç•Œåˆ°è®¡ç®—æœºå¯æ“ä½œä¸–ç•Œçš„ä¸€ç§"ç¿»è¯‘"ã€‚

### æ ¸å¿ƒç‰¹æ€§
1. **å•å°„æ€§å’ŒåŒæž„æ€§**ï¼šEmbedding æ˜¯å•å°„çš„æ˜ å°„ï¼Œæ„å‘³ç€æ¯ä¸ªè¾“å…¥éƒ½æœ‰å”¯ä¸€çš„è¾“å‡ºã€‚
2. **é«˜ç»´åˆ°ä½Žç»´**ï¼šé€šè¿‡ç¨ å¯†å‘é‡è¡¨å¾é«˜ç»´æ•°æ®ï¼Œå‡å°‘è®¡ç®—å¤æ‚åº¦ã€‚
3. **å¯å­¦ä¹ å‚æ•°çŸ©é˜µ**ï¼šEmbedding æ˜¯ä¸€ä¸ªå…¨è¿žæŽ¥å±‚ï¼Œå¯é€šè¿‡è®­ç»ƒä¼˜åŒ–ã€‚

---


## 2. Embedding çš„å®žçŽ°ä¸Žå·¥ä½œæœºåˆ¶

### 2.1 PyTorch å®žçŽ°
åœ¨ PyTorch ä¸­ï¼Œå¸¸ç”¨ `nn.Embedding(vocab_size, embed_dim)` æ¥å®žçŽ°è¯åµŒå…¥ï¼š
- `vocab_size`ï¼šè¯è¡¨å¤§å°ï¼Œå³å¯èƒ½å‡ºçŽ°çš„è¯æ±‡æ€»æ•°ã€‚
- `embed_dim`ï¼šè¯å‘é‡çš„ç»´åº¦ï¼Œå†³å®šäº†æ¯ä¸ªè¯åœ¨å‘é‡ç©ºé—´ä¸­çš„è¡¨ç¤ºå¤æ‚åº¦ã€‚

```python
import torch.nn as nn

# å®šä¹‰ä¸€ä¸ªEmbeddingå±‚
embedding = nn.Embedding(vocab_size=10000, embed_dim=300)

# ç¤ºä¾‹è¾“å…¥ï¼šç´¢å¼•å½¢å¼çš„å•è¯
input_indices = torch.tensor([1, 5, 8])

# è¾“å‡ºï¼šå¯¹åº”çš„è¯å‘é‡
output_vectors = embedding(input_indices)
```

ðŸ’¡ **å¯å‘ç‚¹**ï¼šé€šè¿‡æŸ¥è¡¨ï¼ˆlookupï¼‰ä»£æ›¿çŸ©é˜µä¹˜ç§¯ï¼Œå¤§å¹…æå‡æ€§èƒ½ã€‚

---


### 2.2 Embedding çš„ç‰©ç†æ„ä¹‰
ç”¨ä¸€ä¸ªç®€å•çš„æ¯”å–»ï¼ŒEmbedding å°±åƒåœ°å›¾ï¼š
- åœ°å›¾æ˜¯çŽ°å®žåœ°ç†ä¿¡æ¯çš„äºŒç»´è¡¨ç¤ºï¼Œè€ŒçœŸå®žåœ°å½¢å¯èƒ½æ˜¯å¤šç»´çš„ã€‚
- Embedding å°†æ–‡å­—ã€å›¾ç‰‡ç­‰å¤æ‚æ•°æ®æ˜ å°„åˆ°ä½Žç»´ç©ºé—´ï¼ŒåŒæ—¶å°½é‡ä¿ç•™å…¶è¯­ä¹‰ä¿¡æ¯ã€‚

ðŸ“ˆ **è¶‹åŠ¿é¢„æµ‹**ï¼š
éšç€æ›´å¼ºå¤§çš„æ¨¡åž‹å’Œç¡¬ä»¶æ”¯æŒï¼Œæœªæ¥ Embedding çš„ç»´åº¦å’Œè¡¨çŽ°èƒ½åŠ›å°†è¿›ä¸€æ­¥æå‡ï¼Œå¯èƒ½ä¼šå‡ºçŽ°æ›´é«˜æ•ˆçš„å¤šæ¨¡æ€åµŒå…¥æŠ€æœ¯ã€‚

---


## 3. å¸¸è§é”™è¯¯ä¸Žæ³¨æ„äº‹é¡¹
âš ï¸ **å¸¸è§é”™è¯¯**
- **è¯è¡¨å¤–è¯æ±‡é—®é¢˜**ï¼šå¯¹äºŽæœªåœ¨è®­ç»ƒä¸­å‡ºçŽ°çš„è¯æ±‡ï¼ŒEmbedding å±‚å¯èƒ½æ— æ³•ç”Ÿæˆæœ‰æ•ˆè¡¨ç¤ºã€‚
- **è¿‡å°çš„è¯å‘é‡ç»´åº¦**ï¼šå¯èƒ½å¯¼è‡´è¯­ä¹‰ä¿¡æ¯ä¸¢å¤±ã€‚
- **è¿‡å¤§çš„è¯å‘é‡ç»´åº¦**ï¼šå¯èƒ½å¯¼è‡´è¿‡æ‹Ÿåˆï¼Œå¢žåŠ è®¡ç®—æˆæœ¬ã€‚


---


## 5. è¡ŒåŠ¨æ¸…å•
âœ… å­¦ä¹  PyTorch ä¸­ `nn.Embedding` çš„æ›´å¤šç”¨æ³•  
âœ… æŽ¢ç´¢ä¸åŒç»´åº¦å¤§å°å¯¹æ¨¡åž‹æ€§èƒ½çš„å½±å“  
â—ï¸ å®žéªŒå¦‚ä½•å¤„ç† OOVï¼ˆè¯è¡¨å¤–ï¼‰é—®é¢˜  

---


## 6. [æ€è€ƒ] å»¶ä¼¸é—®é¢˜
1. å¦‚ä½•è®¾è®¡æ›´é«˜æ•ˆçš„ Embedding æ–¹æ³•ä»¥é€‚åº”å¤šæ¨¡æ€æ•°æ®ï¼ˆå¦‚æ–‡æœ¬+å›¾åƒï¼‰ï¼Ÿ
2. åœ¨å®žé™…åº”ç”¨ä¸­ï¼Œå¦‚ä½•å¹³è¡¡ Embedding çš„ç»´åº¦å’Œæ¨¡åž‹æ€§èƒ½ï¼Ÿ
3. æ˜¯å¦å¯ä»¥é€šè¿‡é¢„è®­ç»ƒæŠ€æœ¯è¿›ä¸€æ­¥æå‡ Embedding çš„æ³›åŒ–èƒ½åŠ›ï¼Ÿ

---


## 7. åŽç»­è¿½è¸ªç ”ç©¶è®¡åˆ’
- æŽ¢ç´¢åŸºäºŽ Transformer çš„åŠ¨æ€è¯åµŒå…¥æ–¹æ³•ã€‚
- æ¯”è¾ƒä¸åŒæ·±åº¦å­¦ä¹ æ¡†æž¶ä¸­ Embedding å±‚çš„å®žçŽ°å·®å¼‚ã€‚
- è°ƒç ”æœ€æ–°çš„å¤šæ¨¡æ€åµŒå…¥æŠ€æœ¯åŠå…¶åº”ç”¨åœºæ™¯ã€‚

---

>

```mermaid
graph TD
    A["è¾“å…¥æ–‡æœ¬: 'Playing with fire.'"] --> B[BBPE åˆ†è¯å™¨]
    B --> C["Token IDs: [12139, 356, 703, 1123, 13]"]
    C --> D["æŸ¥åµŒå…¥çŸ©é˜µ: nn.Embedding(50257, 768)"]
    D --> E["è¾“å‡º shape: (5, 768) åµŒå…¥å‘é‡"]
    E --> F[Transformer ç¼–ç å™¨]
    F --> G[é¢„æµ‹ä¸‹ä¸€ä¸ª token]
    G --> H[è®¡ç®— Loss]
    H --> I[åå‘ä¼ æ’­]
    I --> D

```
