---
{"dg-publish":true,"dg-permalink":"/å¤§è¯­è¨€æ¨¡å‹å­¦ä¹ /è®­ç»ƒæ¨ç†ä¼˜åŒ–/FlashAttention/ä»‹ç»","dg-home":false,"dg-description":"åœ¨æ­¤è¾“å…¥ç¬”è®°çš„æè¿°","dg-hide":false,"dg-hide-title":false,"dg-show-backlinks":true,"dg-show-local-graph":true,"dg-show-inline-title":true,"dg-pinned":false,"dg-passphrase":"åœ¨æ­¤è¾“å…¥è®¿é—®å¯†ç ","dg-enable-mathjax":false,"dg-enable-mermaid":false,"dg-enable-uml":false,"dg-note-icon":0,"dg-enable-dataview":false,"tags":["NLP"],"permalink":"/å¤§è¯­è¨€æ¨¡å‹å­¦ä¹ /è®­ç»ƒæ¨ç†ä¼˜åŒ–/FlashAttention/ä»‹ç»/","dgShowBacklinks":true,"dgShowLocalGraph":true,"dgShowInlineTitle":true,"dgPassFrontmatter":true,"noteIcon":0,"created":"2025-04-28T22:19:52.000+08:00","updated":"2025-04-29T11:00:58.000+08:00"}
---



# FlashAttentionï¼šåŠ é€Ÿä¸èŠ‚çœæ˜¾å­˜çš„ç²¾ç¡®æ³¨æ„åŠ›æœºåˆ¶
å…ƒæ•°æ®ï¼š

åˆ†ç±»ï¼šäººå·¥æ™ºèƒ½æŠ€æœ¯

æ ‡ç­¾ï¼šFlashAttention, Transformer, è®¡ç®—ä¼˜åŒ–, æ˜¾å­˜èŠ‚çœ, IOæ„ŸçŸ¥

æ—¥æœŸï¼š2025å¹´4æœˆ12æ—¥

## æ ¸å¿ƒè§‚ç‚¹æ€»ç»“
FlashAttentionæå‡ºäº†ä¸€ç§åˆ›æ–°çš„æ³¨æ„åŠ›æœºåˆ¶ï¼Œé€šè¿‡åŠ é€Ÿè®¡ç®—å’ŒèŠ‚çœæ˜¾å­˜æ¥ä¼˜åŒ–Transformeræ¨¡å‹ã€‚å®ƒçš„è®¾è®¡æ—¨åœ¨è§£å†³éšç€åºåˆ—é•¿åº¦ $N$ çš„äºŒæ¬¡å¢é•¿æ‰€å¸¦æ¥çš„èµ„æºå’Œæ•ˆç‡é—®é¢˜ã€‚ä¸ä¼ ç»Ÿæ³¨æ„åŠ›æœºåˆ¶ä¸åŒï¼ŒFlashAttentionåœ¨ä¿æŒç»“æœç²¾ç¡®çš„åŒæ—¶å‡å°‘äº†æ˜¾å­˜å¤æ‚åº¦å’Œè®¡ç®—æ—¶é—´ã€‚


## é‡ç‚¹æ®µè½ä¸æ•°æ®

### åŠ é€Ÿè®¡ç®—ï¼ˆFastï¼‰
- FlashAttentioné€šè¿‡IOæ„ŸçŸ¥å‡å°‘HBMè®¿é—®æ¬¡æ•°æ¥åŠ å¿«è®¡ç®—é€Ÿåº¦ï¼Œè€Œä¸æ˜¯å‡å°‘è®¡ç®—é‡ï¼ˆFLOPsï¼‰ã€‚
- ä½¿ç”¨äº†åˆ†å—æŠ€æœ¯ï¼ˆtilingï¼‰å’Œç®—å­èåˆæ¥å®ç°è¿™ä¸€ç›®æ ‡ã€‚


### æ˜¾å­˜èŠ‚çœï¼ˆMemory-efficientï¼‰
- é€šè¿‡å¼•å…¥ç»Ÿè®¡é‡ï¼Œæ”¹å˜æ³¨æ„åŠ›æœºåˆ¶çš„è®¡ç®—é¡ºåºï¼Œé¿å…å®ä¾‹åŒ–æ³¨æ„åŠ›çŸ©é˜µã€‚
- æ˜¾å­˜å¤æ‚åº¦ä» $O(N^2)$ é™ä½åˆ°äº† $O(N)$ã€‚


### ç²¾ç¡®æ³¨æ„åŠ›ï¼ˆExact Attentionï¼‰
- FlashAttentionä¸åŸç”Ÿæ³¨æ„åŠ›çš„ç»“æœå®Œå…¨ç­‰ä»·ï¼Œä¸åŒäºç¨€ç–æ³¨æ„åŠ›ï¼Œå®ƒåªæ˜¯åˆ†å—è®¡ç®—ï¼Œè€Œä¸æ˜¯è¿‘ä¼¼è®¡ç®—ã€‚


## æŠ€æœ¯æœ¯è¯­é€šä¿—è§£é‡Š
- **IOæ„ŸçŸ¥**ï¼šæŒ‡çš„æ˜¯åœ¨è®¡ç®—è¿‡ç¨‹ä¸­ä¼˜åŒ–è¾“å…¥è¾“å‡ºæ“ä½œä»¥å‡å°‘å»¶è¿Ÿã€‚
- **HBMè®¿é—®**ï¼šæŒ‡çš„æ˜¯é«˜å¸¦å®½å†…å­˜çš„è®¿é—®æ¬¡æ•°ï¼Œå‡å°‘è¿™äº›è®¿é—®å¯ä»¥æé«˜è®¡ç®—æ•ˆç‡ã€‚
- **åˆ†å—æŠ€æœ¯ï¼ˆTilingï¼‰**ï¼šå°†å¤§ä»»åŠ¡åˆ†æˆå°å—æ¥å¤„ç†ï¼Œä»¥æé«˜æ•ˆç‡ã€‚
- **ç®—å­èåˆ**ï¼šå°†å¤šä¸ªè®¡ç®—æ­¥éª¤åˆå¹¶ä¸ºä¸€ä¸ªï¼Œä»¥å‡å°‘ä¸­é—´æ­¥éª¤å’Œå†…å­˜ä½¿ç”¨ã€‚


## æ“ä½œæ­¥éª¤
1. âœ… ä½¿ç”¨åˆ†å—æŠ€æœ¯è¿›è¡Œè®¡ç®—ä»»åŠ¡åˆ†å‰²ã€‚
2. âš  é¿å…å®ä¾‹åŒ–å®Œæ•´çš„æ³¨æ„åŠ›çŸ©é˜µã€‚
3. â— å¼•å…¥ç»Ÿè®¡é‡ä»¥ä¼˜åŒ–è®¡ç®—é¡ºåºã€‚


## å¸¸è§é”™è¯¯
> æ³¨æ„é¿å…åœ¨å®ç°è¿‡ç¨‹ä¸­å¿½ç•¥äº†IOæ„ŸçŸ¥çš„é‡è¦æ€§ï¼Œè¿™å¯èƒ½å¯¼è‡´è®¡ç®—æ•ˆç‡æœªèƒ½è¾¾åˆ°é¢„æœŸã€‚


## ğŸ’¡ å¯å‘ç‚¹
FlashAttentionçš„åˆ›æ–°åœ¨äºå®ƒé€šè¿‡æ”¹å˜è®¡ç®—é¡ºåºå’Œæ•°æ®å¤„ç†æ–¹å¼æ¥ä¼˜åŒ–èµ„æºä½¿ç”¨ï¼Œè€Œä¸æ˜¯ç®€å•åœ°å‡å°‘è®¡ç®—é‡ã€‚è¿™ç§æ–¹æ³•ä¸ºå…¶ä»–é¢†åŸŸçš„ä¼˜åŒ–æä¾›äº†æ–°çš„æ€è·¯ã€‚


## è¡ŒåŠ¨æ¸…å•
- ç ”ç©¶FlashAttentionåœ¨ä¸åŒæ¨¡å‹ä¸­çš„åº”ç”¨æ•ˆæœã€‚
- æ¢ç´¢åˆ†å—æŠ€æœ¯å¦‚ä½•åœ¨å…¶ä»–è®¡ç®—ä»»åŠ¡ä¸­åº”ç”¨ã€‚
- åˆ†ææ˜¾å­˜èŠ‚çœå¯¹å¤§å‹æ¨¡å‹è®­ç»ƒçš„å½±å“ã€‚

> æ¥æºï¼šè®ºæ–‡ã€ŠFlashAttention: Fast and Memory-Efficient Exact Attention with IO-Awarenessã€‹åŠç›¸å…³çŸ¥ä¹æ–‡ç« ã€‚(https://zhuanlan.zhihu.com/p/669926191 ï¼Œ https://zhuanlan.zhihu.com/p/676655352 ï¼Œ https://zhuanlan.zhihu.com/p/663932651)
