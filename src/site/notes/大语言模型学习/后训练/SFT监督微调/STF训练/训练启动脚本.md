---
{"dg-publish":true,"dg-permalink":"/å¤§è¯­è¨€æ¨¡åž‹å­¦ä¹ /åŽè®­ç»ƒ/SFTç›‘ç£å¾®è°ƒ/STFè®­ç»ƒ/è®­ç»ƒå¯åŠ¨è„šæœ¬","dg-home":false,"dg-description":"åœ¨æ­¤è¾“å…¥ç¬”è®°çš„æè¿°","dg-hide":false,"dg-hide-title":false,"dg-show-backlinks":true,"dg-show-local-graph":true,"dg-show-inline-title":true,"dg-pinned":false,"dg-passphrase":"åœ¨æ­¤è¾“å…¥è®¿é—®å¯†ç ","dg-enable-mathjax":false,"dg-enable-mermaid":false,"dg-enable-uml":false,"dg-note-icon":0,"dg-enable-dataview":false,"tags":["NLP"],"permalink":"/å¤§è¯­è¨€æ¨¡åž‹å­¦ä¹ /åŽè®­ç»ƒ/SFTç›‘ç£å¾®è°ƒ/STFè®­ç»ƒ/è®­ç»ƒå¯åŠ¨è„šæœ¬/","dgShowBacklinks":true,"dgShowLocalGraph":true,"dgShowInlineTitle":true,"dgPassFrontmatter":true,"noteIcon":0,"created":"2025-04-11T13:07:45.000+08:00","updated":"2025-04-13T13:06:02.000+08:00"}
---



# SFTè®­ç»ƒä¸Žè¯„ä¼°æŒ‡å—ï¼šæå‡æ¨¡åž‹è¡¨çŽ°çš„å…³é”®æ­¥éª¤
åˆ†ç±»ï¼šæœºå™¨å­¦ä¹ 

æ ‡ç­¾ï¼šSFTè®­ç»ƒï¼Œæ¨¡åž‹è¯„ä¼°ï¼Œæ·±åº¦å­¦ä¹ 

æ—¥æœŸï¼š2023å¹´10æœˆ22æ—¥

## æ ¸å¿ƒè§‚ç‚¹æ€»ç»“
åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼ŒSFTï¼ˆSupervised Fine-Tuningï¼‰è®­ç»ƒå’Œè¯„ä¼°æ˜¯æå‡æ¨¡åž‹æ€§èƒ½çš„é‡è¦çŽ¯èŠ‚ã€‚æœ¬æ–‡ä»‹ç»äº†OpenRLHFæ¡†æž¶ä¸‹çš„SFTè®­ç»ƒå¯åŠ¨è„šæœ¬ï¼Œå¹¶è¯¦ç»†é˜è¿°äº†SFTè¯„ä¼°çš„åŽŸåˆ™å’Œæ–¹æ³•ã€‚é€šè¿‡ç»“åˆæœºè¯„å’Œäººè¯„ï¼Œå¯ä»¥æ›´å…¨é¢åœ°è¯„ä¼°æ¨¡åž‹åœ¨ä¸åŒç»´åº¦ä¸Šçš„è¡¨çŽ°ã€‚


## é‡ç‚¹æ®µè½
1. **SFTè®­ç»ƒå¯åŠ¨è„šæœ¬**  
   ä½¿ç”¨OpenRLHFè¿›è¡ŒSFTè®­ç»ƒçš„å¯åŠ¨è„šæœ¬ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•è®¾ç½®è®­ç»ƒå‚æ•°ï¼ŒåŒ…æ‹¬æœ€å¤§é•¿åº¦ã€æ•°æ®é›†ã€æ‰¹é‡å¤§å°ã€é¢„è®­ç»ƒæ¨¡åž‹ã€ä¿å­˜è·¯å¾„ç­‰ã€‚

2. **è¯„ä¼°åŽŸåˆ™**  
   SFTè¯„ä¼°éœ€è¦å…³æ³¨æ¨¡åž‹çš„Helpfulnessï¼ˆå¸®åŠ©æ€§ï¼‰ã€Honestyï¼ˆè¯šå®žæ€§ï¼‰å’ŒHarmlessnessï¼ˆæ— å®³æ€§ï¼‰ã€‚æ­¤å¤–ï¼Œè¿˜éœ€æ ¹æ®éœ€æ±‚åˆ¶å®šå…¶ä»–æŒ‡æ ‡ï¼Œå¦‚æŒ‡ä»¤éµå¾ªã€å†…å®¹å‡†ç¡®æ€§å’Œå®‰å…¨æ€§ã€‚

3. **æœºè¯„ä¸Žäººè¯„**  
   æœºè¯„åˆ©ç”¨å¤§æ¨¡åž‹å¦‚GPT4è¿›è¡Œï¼Œéœ€ç²¾å¿ƒè®¾è®¡promptä»¥å‡å°‘åå·®ï¼›äººè¯„åˆ™é€šè¿‡äººå·¥ç›´æŽ¥åˆ¤æ–­æ¨¡åž‹è¾“å‡ºçš„è´¨é‡ã€‚


## æ“ä½œæ­¥éª¤
1. âœ… **å¯åŠ¨è®­ç»ƒ**  
   ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨SFTè®­ç»ƒï¼š
   ```bash
   openrlhf.cli.train_sft \
   --max_len 2048 \
   --dataset xxx \
   --input_key question \
   --output_key response \
   --train_batch_size 256 \
   --micro_train_batch_size 2 \
   --max_samples 500000 \
   --pretrain meta-llama/Meta-Llama-3-8B \
   --save_path ./checkpoint/llama3-8b-sft \
   --save_steps -1 \
   --logging_steps 1 \
   --eval_steps -1 \
   --zero_stage 2 \
   --max_epochs 1 \
   --bf16 \
   --flash_attn \
   --learning_rate 5e-6 \
   --load_checkpoint \
   --gradient_checkpointing
   ```





2. âš  **æ³¨æ„äº‹é¡¹**  
   - ç¡®ä¿æ•°æ®é›†å’Œé¢„è®­ç»ƒæ¨¡åž‹è·¯å¾„æ­£ç¡®ã€‚
   - è°ƒæ•´å­¦ä¹ çŽ‡ä»¥é€‚åº”ä¸åŒæ•°æ®é›†ã€‚

3. â— **è¯„ä¼°å‡†å¤‡**  
   å‡†å¤‡ä¸Žè®­ç»ƒé›†ä¸€è‡´çš„é«˜è´¨é‡è¯„æµ‹é›†åˆï¼Œç¡®ä¿è¯„ä¼°ä»»åŠ¡ç±»åž‹æ˜Žç¡®ã€‚


## å¸¸è§é”™è¯¯
> åœ¨å¯åŠ¨è®­ç»ƒæ—¶ï¼Œå¸¸è§é”™è¯¯åŒ…æ‹¬è·¯å¾„é…ç½®é”™è¯¯ã€å‚æ•°è®¾ç½®ä¸å½“ä»¥åŠæœªå……åˆ†è€ƒè™‘æ•°æ®é›†ç‰¹ç‚¹ç­‰ã€‚è¿™äº›é”™è¯¯å¯èƒ½å¯¼è‡´è®­ç»ƒå¤±è´¥æˆ–ç»“æžœä¸ç†æƒ³ã€‚


## ðŸ’¡å¯å‘ç‚¹
- åœ¨è®¾è®¡è¯„ä¼°æŒ‡æ ‡æ—¶ï¼Œå¦‚ä½•å¹³è¡¡ä¸åŒç»´åº¦çš„æƒé‡ï¼Ÿ
- å¦‚ä½•æ›´å¥½åœ°åˆ©ç”¨å¤§æ¨¡åž‹è¿›è¡Œæœºè¯„ä»¥å‡å°‘åå·®ï¼Ÿ


## è¡ŒåŠ¨æ¸…å•
- [ ] ä¼˜åŒ–è®­ç»ƒè„šæœ¬å‚æ•°ä»¥æé«˜æ•ˆçŽ‡ã€‚
- [ ] åˆ¶å®šè¯¦ç»†çš„è¯„ä¼°æŒ‡æ ‡å¹¶æµ‹è¯•å…¶æœ‰æ•ˆæ€§ã€‚
- [ ] æŽ¢ç´¢æ›´å¤šè¯„ä¼°æ–¹æ³•ä»¥æå‡ç»“æžœå‡†ç¡®æ€§ã€‚


## ðŸ“ˆè¶‹åŠ¿é¢„æµ‹
éšç€å¤§æ¨¡åž‹çš„ä¸æ–­å‘å±•ï¼Œæœªæ¥SFTè®­ç»ƒå’Œè¯„ä¼°å°†æ›´åŠ ä¾èµ–äºŽè‡ªåŠ¨åŒ–å·¥å…·å’Œæ›´æ™ºèƒ½çš„è¯„ä¼°æŒ‡æ ‡ï¼Œä»¥æé«˜æ•ˆçŽ‡å’Œå‡†ç¡®æ€§ã€‚


## åŽç»­è¿½è¸ª
- ç ”ç©¶å¦‚ä½•ç»“åˆæ›´å¤šæ•°æ®æºè¿›è¡Œå¤šç»´åº¦è¯„ä¼°ã€‚
- æŽ¢ç´¢æ–°åž‹è¯„ä¼°ç®—æ³•ä»¥æé«˜æœºè¯„å‡†ç¡®æ€§ã€‚

> åŽŸå§‹å‡ºå¤„ï¼šæ­¤å†…å®¹åŸºäºŽOpenRLHFæ¡†æž¶çš„SFTè®­ç»ƒä¸Žè¯„ä¼°æ–‡æ¡£ã€‚
