<template><div><p><img src="/img/user/附件/Pasted image 20250429223411.png" alt="Pasted image 20250429223411.png"></p>
<h2 id="混合精度训练" tabindex="-1"><a class="header-anchor" href="#混合精度训练"><span>混合精度训练</span></a></h2>
<p>在训练过程中，DeepSpeed 支持同时使用 FP16 和 FP32 两种精度的数据类型。具体而言，在进行前向传播（forward）和反向传播（backward）时，数据类型会转换为 FP16，而在参数更新阶段则转换为 FP32。这种方法可以有效提高训练效率，同时保持较高的计算精度。关于混合精度训练的详细信息，可以参考 2.3.7 章。
<img src="/img/user/附件/Pasted image 20250429223429.png" alt="Pasted image 20250429223429.png"></p>
<h2 id="zero-零冗余优化器" tabindex="-1"><a class="header-anchor" href="#zero-零冗余优化器"><span>ZeRO 零冗余优化器</span></a></h2>
<h3 id="zero的显存分类" tabindex="-1"><a class="header-anchor" href="#zero的显存分类"><span>ZeRO的显存分类</span></a></h3>
<p>ZeRO 优化器通过显存的精细管理来提高模型训练的效率，其显存分类如下：</p>
<ul>
<li>
<p><strong>模型状态（model states）</strong>：包括模型参数（FP16）、模型梯度（FP16）和 Adam 状态（FP32 的模型参数备份，FP32 的 momentum 和 FP32 的 variance）。假设模型参数量为 <span v-pre class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Φ</mi></mrow><annotation encoding="application/x-tex">\Phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Φ</span></span></span></span>，则共需要存储空间为 <span v-pre class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi mathvariant="normal">Φ</mi><mo>+</mo><mn>2</mn><mi mathvariant="normal">Φ</mi><mo>+</mo><mo stretchy="false">(</mo><mn>4</mn><mi mathvariant="normal">Φ</mi><mo>+</mo><mn>4</mn><mi mathvariant="normal">Φ</mi><mo>+</mo><mn>4</mn><mi mathvariant="normal">Φ</mi><mo stretchy="false">)</mo><mo>=</mo><mn>4</mn><mi mathvariant="normal">Φ</mi><mo>+</mo><mn>12</mn><mi mathvariant="normal">Φ</mi><mo>=</mo><mn>16</mn><mi mathvariant="normal">Φ</mi></mrow><annotation encoding="application/x-tex">2\Phi + 2\Phi + (4\Phi + 4\Phi + 4\Phi) = 4\Phi + 12\Phi = 16\Phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord">2Φ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord">2Φ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">4Φ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord">4Φ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">4Φ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord">4Φ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">12Φ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">16Φ</span></span></span></span> 字节。可以看到，Adam 优化器状态占据了显存的 75%，而更新参数时还需加上 FP32 的梯度。</p>
</li>
<li>
<p><strong>剩余状态（residual states）</strong>：包括激活值（activation）、各种临时缓冲区（buffer）以及无法使用的显存碎片（fragmentation）。其中，激活值可以通过 activation checkpointing 来大幅减少。</p>
</li>
</ul>
<h3 id="zero-三个阶段以及显存占用分析" tabindex="-1"><a class="header-anchor" href="#zero-三个阶段以及显存占用分析"><span>ZeRO 三个阶段以及显存占用分析</span></a></h3>
<p><img src="/img/user/附件/Pasted image 20250429223450.png" alt="Pasted image 20250429223450.png"></p>
<h4 id="数据通信量分析" tabindex="-1"><a class="header-anchor" href="#数据通信量分析"><span>数据通信量分析</span></a></h4>
<p>DeepSpeed ZeRO 主要采用数据并行的方法。</p>
<h5 id="传统数据并行" tabindex="-1"><a class="header-anchor" href="#传统数据并行"><span>传统数据并行</span></a></h5>
<p>在传统的数据并行中，每一步（step/iteration）计算梯度后，需要进行一次 AllReduce 操作来计算梯度均值。常用的方法是 Ring AllReduce，分为 ReduceScatter 和 AllGather 两步，每张卡的通信数据量（发送+接受）近似为 <span v-pre class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mi mathvariant="normal">Φ</mi></mrow><annotation encoding="application/x-tex">4\Phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">4Φ</span></span></span></span>。</p>
<p><img src="/img/user/附件/Pasted image 20250429223505.png" alt="Pasted image 20250429223505.png">
<img src="/img/user/附件/Pasted image 20250429223527.png" alt="Pasted image 20250429223527.png">
<img src="/img/user/附件/Pasted image 20250429223535.png" alt="Pasted image 20250429223535.png"></p>
<h5 id="zero1、2阶段-优化器状态分区、梯度分区" tabindex="-1"><a class="header-anchor" href="#zero1、2阶段-优化器状态分区、梯度分区"><span>ZeRO1、2阶段（优化器状态分区、梯度分区）</span></a></h5>
<p>在 ZeRO1 和 ZeRO2 阶段，与传统数据并行类似。每张卡只存储 <span v-pre class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 的优化器状态和梯度。对于 gpu_0 来说，为了计算它这 <span v-pre class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 的梯度均值，需要进行一次 Reduce 操作，通信数据量是 <span v-pre class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>⋅</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mo>⋅</mo><mi mathvariant="normal">Φ</mi><mo>⋅</mo><mi>N</mi><mo>=</mo><mn>2</mn><mi mathvariant="normal">Φ</mi></mrow><annotation encoding="application/x-tex">2 \cdot \frac{1}{N} \cdot \Phi \cdot N = 2\Phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Φ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">2Φ</span></span></span></span>（发送+接收）。实现中使用了 bucket 策略，保证 <span v-pre class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 的梯度每张卡只发送一次。当 gpu_0 计算好梯度均值后，就可以更新局部的优化器状态（包括 <span v-pre class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac><mo>⋅</mo><mi mathvariant="normal">Φ</mi></mrow><annotation encoding="application/x-tex">\frac{1}{N} \cdot \Phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Φ</span></span></span></span> 的参数），当反向传播过程结束，进行一次 Gather 操作，更新 <span v-pre class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mo stretchy="false">)</mo><mo>⋅</mo><mi mathvariant="normal">Φ</mi></mrow><annotation encoding="application/x-tex">(1 - \frac{1}{N}) \cdot \Phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Φ</span></span></span></span> 的模型参数，通信数据量是 <span v-pre class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>⋅</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mo>⋅</mo><mi mathvariant="normal">Φ</mi><mo>⋅</mo><mi>N</mi><mo>=</mo><mn>2</mn><mi mathvariant="normal">Φ</mi></mrow><annotation encoding="application/x-tex">2 \cdot \frac{1}{N} \cdot \Phi \cdot N = 2\Phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Φ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">2Φ</span></span></span></span>（发送+接收）。全局来看，相当于用 Reduce-Scatter 和 AllGather 两步，与数据并行一致。
<img src="/img/user/附件/Pasted image 20250429223545.png" alt="Pasted image 20250429223545.png"></p>
<h5 id="深入理解-zero3-与-cpu-卸载技术" tabindex="-1"><a class="header-anchor" href="#深入理解-zero3-与-cpu-卸载技术"><span>深入理解 ZERO3 与 CPU 卸载技术</span></a></h5>
<p>在深度学习的训练过程中，模型参数的存储和计算效率一直是研究的重点。本文将详细探讨 ZERO3 技术以及 CPU 卸载策略如何优化深度学习模型的训练过程。
<img src="/img/user/附件/Pasted image 20250429223811.png" alt="Pasted image 20250429223811.png"></p>
<h6 id="通信效率分析" tabindex="-1"><a class="header-anchor" href="#通信效率分析"><span>通信效率分析</span></a></h6>
<p>ZERO3 的通信量为 <span v-pre class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn><mi mathvariant="normal">Φ</mi></mrow><annotation encoding="application/x-tex">6\Phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">6Φ</span></span></span></span>，相较于标准的数据并行，通信效率提升了 <span v-pre class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1.5</mn></mrow><annotation encoding="application/x-tex">1.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1.5</span></span></span></span> 倍。这种提升主要得益于参数的分片存储和有效的通信策略。</p>
<h6 id="cpu卸载策略" tabindex="-1"><a class="header-anchor" href="#cpu卸载策略"><span>CPU卸载策略</span></a></h6>
<p>CPU卸载技术不仅仅是将数据卸载到 CPU，还包括将部分计算任务转移到 CPU，从而显著减少 GPU - CPU 之间的通信量。</p>
<h6 id="cpu卸载的优化目标" tabindex="-1"><a class="header-anchor" href="#cpu卸载的优化目标"><span>CPU卸载的优化目标</span></a></h6>
<p>CPU卸载应满足以下三个方面的最优：</p>
<ol>
<li><strong>减少CPU的计算量</strong>：避免 CPU 成为性能瓶颈。</li>
<li><strong>最小化GPU - CPU之间的通信量</strong>：避免通信开销成为性能瓶颈。</li>
<li><strong>在最小化通信量时，最大化GPU的显存节省</strong>。</li>
</ol>
<h6 id="数据卸载策略" tabindex="-1"><a class="header-anchor" href="#数据卸载策略"><span>数据卸载策略</span></a></h6>
<ul>
<li><strong>FP32的模型参数、优化器状态</strong>：这些被卸载到 CPU。</li>
<li><strong>FP16的模型参数、中间激活</strong>：这些则保留在 GPU 上。</li>
</ul>
<h6 id="计算卸载策略" tabindex="-1"><a class="header-anchor" href="#计算卸载策略"><span>计算卸载策略</span></a></h6>
<ul>
<li><strong>优化器更新模型参数</strong>：这部分计算任务被卸载到 CPU。</li>
<li><strong>前向传递和后向传递</strong>：这些计算任务依然在 GPU 上进行。</li>
</ul>
<h6 id="通信量分析" tabindex="-1"><a class="header-anchor" href="#通信量分析"><span>通信量分析</span></a></h6>
<p>在 CPU卸载策略中，通信涉及到 FP16 的梯度和模型参数。这种策略有效地减少了 GPU 和 CPU 之间的数据传输需求。
<img src="/img/user/附件/Pasted image 20250429223825.png" alt="Pasted image 20250429223825.png"><img src="/img/user/附件/Pasted image 20250429223831.png" alt="Pasted image 20250429223831.png"></p>
</div></template>


